<head>
  <title>Meteor Santa</title>
</head>
<body>
  <div class="container">
    <div class="row">
      <div class="col-md-offset-4 col-md-4">
        <h1>Secret Santa</h1>
        {{> Login}}
        {{#if currentUser}}
          {{> Matching}}
          {{> Profile}}
        {{/if}}

        {{> All}}
        <h3>Instructions</h3>
        <ol>
          <li>Log in with any username</li>
          <li>Ensure at least 4 users are logged in from other browsers (incognito)</li>
          <li>Pair up with your love interest</li>
          <li>Match santas</li>
        </ol>
      </div>
    </div>
  </div>
</body>

<template name="Matching">
  {{#if giftee}}
    <p>You are <strong>{{giftee.username}}</strong>'s secret santa</p>
  {{else}}
    <p>You are not a secret santa</p>
  {{/if}}
  <button type="submit" class="btn btn-primary {{#if isMatchReady}} {{else}} disabled {{/if}}">Match Santas</button>
  <button type="reset" class="btn btn-warning">Clear Matches</button>
</template>

<template name="Profile">
  <h3>How single?</h3>
  <form>
      <label class="radio-inline">
        <input type="radio" name="single" value="true" {{single}}>
        Single
      </label>
      <label class="radio-inline">
        <input type="radio" name="single" value="false" {{conjoint}}>
        Conjoint
      </label>
  </form>
  {{#if isConjoint}}
    {{> Conjoint}}
  {{/if}}
</template>

<template name="Conjoint">
  <p>Who's your sweetheart?</p>
  <form class="form-inline">
    <select id="username-select" class="form-control">
      <option disabled="disabled" selected="selected">Pick your love</option>
      {{#each usernames}}
        <option value="{{this}}">{{this}}</option>
      {{/each}}
    </select>
  </form>
</template>

<template name="All">
  <h3>Players</h3>
  <ul>
    {{#each users}}
      <li>{{username}}</li>
    {{/each}}
  </ul>
</template>

<template name="Login">
  {{#if loggedIn}}
  {{> loginButtons}}
  {{else}}
  <form class="form-inline">
    {{! We use the pattern below because it matches \w in in autocomplete for user names}}
    <input class="form-control" type="text" name="username" required pattern="^[a-zA-Z][a-zA-Z0-9_]{5,12}$" placeholder="Username..." title="6-13 numbers or characters.">
    <button type="submit" class="btn btn-primary">Login</button>
  </form>
  {{/if}}
</template>
